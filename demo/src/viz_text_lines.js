'use strict';

// timings.forEach( v => {
//   console.log(`['${v.key}', ${v.t}],`);
// })
let startTime;
let currTime = 1000;
let idx = 0;

let typed = [
  { key: 'A', t: 1652.4099999951432 },
  { key: ' ', t: 1885.6349999987287 },
  { key: 'w', t: 2062.7150000000256 },
  { key: 'a', t: 2129.479999995965 },
  { key: 'r', t: 2345.1099999947473 },
  { key: 'm', t: 2499.9600000010105 },
  { key: ' ', t: 2599.7349999961443 },
  { key: 'w', t: 2883.705000000191 },
  { key: 'i', t: 3049.3249999999534 },
  { key: 'n', t: 3117.8450000006706 },
  { key: 't', t: 3267.549999996845 },
  { key: 'e', t: 3417.1749999950407 },
  { key: 'r', t: 3519.5699999967474 },
  { key: ' ', t: 3649.519999999029 },
  { key: 'b', t: 4185.089999999036 },
  { key: 'r', t: 4469.389999998384 },
  { key: 'e', t: 4721.655000001192 },
  { key: 'e', t: 4865.409999998519 },
  { key: 'z', t: 5137.094999998226 },
  { key: 'e', t: 5337.064999999711 },
  { key: ' ', t: 5499.875000001339 },
  { key: 's', t: 5669.4900000002235 },
  { key: 'e', t: 5865.319999997155 },
  { key: 'p', t: 6298.389999996289 },
  { key: 'a', t: 6505.03999999637 },
  { key: 'r', t: 6704.014999995707 },
  { key: 'a', t: 6803.794999999809 },
  { key: 't', t: 7003.635000000941 },
  { key: 'e', t: 7104.289999995672 },
  { key: 's', t: 7233.2749999986845 },
  { key: ' ', t: 7389.084999995248 },
  { key: 'h', t: 7537.229999994452 },
  { key: 'e', t: 7638.374999994994 },
  { key: 'r', t: 7720.889999996871 },
  { key: ' ', t: 7817.60999999824 },
  { key: 's', t: 7985.519999994722 },
  { key: 'h', t: 8088.084999995772 },
  { key: 'e', t: 8199.984999999288 },
  { key: 'e', t: 8618.62999999721 },
  { key: 't', t: 8855.389999996987 },
  { key: 's', t: 8937.409999998636 },
  { key: ',', t: 9217.219999998633 },
  { key: ' ', t: 9322.684999999183 },
  { key: 'a', t: 9490.474999998696 },
  { key: ' ', t: 9550.544999998237 },
  { key: 'y', t: 9913.094999996247 },
  { key: 'a', t: 10006.954999997106 },
  { key: 'w', t: 10068.155000000843 },
  { key: 'n', t: 10251.094999999623 },
  { key: '.', t: 11257.324999998673 },
  { key: ' ', t: 11277.324999998673 },

  { key: 'P', t: 11584.954999998445 },
  { key: 'a', t: 11741.139999998268 },
  { key: 'r', t: 11873.664999999164 },
  { key: 't', t: 12076.174999994691 },
  { key: 'i', t: 12158.165000000736 },
  { key: 'n', t: 12209.104999994452 },
  { key: 'g', t: 12305.459999995946 },
  { key: ' ', t: 12391.319999995176 },
  { key: 'h', t: 12558.039999996254 },
  { key: 'e', t: 12688.944999994419 },
  { key: 'r', t: 12773.470000000088 },
  { key: ' ', t: 12852.735000000393 },
  { key: 'h', t: 13066.759999994247 },
  { key: 'a', t: 13153.760000001057 },
  { key: 'i', t: 13289.594999994733 },
  { key: 'r', t: 13325.384999996459 },
  { key: ' ', t: 13570.309999995516 },
  { key: 'r', t: 13977.104999998119 },
  { key: 'i', t: 14110.354999997071 },
  { key: 's', t: 14244.064999998955 },
  { key: 'i', t: 14377.244999996037 },
  { key: 'n', t: 14457.129999995232 },
  { key: 'g', t: 14553.68499999895 },
  { key: ' ', t: 14665.91999999946 },
  { key: 's', t: 14810.214999997697 },
  { key: 'h', t: 14889.81000000058 },
  { key: 'e', t: 15001.1599999998 },
  { key: 'e', t: 15104.97999999643 },
  { key: 't', t: 15289.184999994177 },
  { key: 's', t: 15386.124999997264 },
  { key: ' ', t: 15472.77000000031 },
  { key: 's', t: 15661.35999999824 },
  { key: 'w', t: 15839.954999995825 },
  { key: 'e', t: 15845.000000000 },
  { key: 'p', t: 16056.899999995949 },
  { key: 't', t: 16242.209999996703 },
  { key: ' ', t: 16400.770000000193 },
  { key: 'a', t: 16525.709999994433 },
  { key: 'n', t: 16629.484999997658 },
  { key: 'd', t: 16720.94500000094 },
  { key: ' ', t: 16795.48999999679 },
  { key: 't', t: 16929.77499999688 },
  { key: 'h', t: 16978.979999999865 },
  { key: 'e', t: 17079.25499999692 },
  { key: 'n', t: 17190.429999995104 },
  { key: ' ', t: 17258.07999999961 },
  { key: 'g', t: 17423.234999994747 },
  { key: 'o', t: 17473.409999998694 },
  { key: 'n', t: 17562.93999999616 },
  { key: 'e', t: 17697.049999995215 },
  { key: '.', t: 17997.145000001183 },
  { key: ' ', t: 18132.584999998217 },

  { key: 'D', t: 18162.584999998217 },
  { key: 'e', t: 18313.77000000066 },
  { key: 'c', t: 18808.71499999921 },
  { key: 'a', t: 18909.104999998817 },
  { key: 'y', t: 19108.629999995173 },
  { key: 'i', t: 19281.754999996338 },
  { key: 'n', t: 19347.38500000094 },
  { key: 'g', t: 19473.610000000917 },
  { key: ' ', t: 19559.159999997064 },
  { key: 'd', t: 19730.884999997215 },
  { key: 'r', t: 19937.61000000086 },
  { key: 'e', t: 20014.989999996033 },
  { key: 'a', t: 20082.22499999829 },
  { key: 'm', t: 20182.54999999772 },
  { key: 's', t: 20199.54999999772 },
  { key: ' ', t: 20232.969999997295 },
  { key: 'u', t: 20465.539999997418 },
  { key: 'n', t: 20676.729999999225 },
  { key: 'd', t: 20809.009999997215 },
  { key: 'e', t: 20965.294999994512 },
  { key: 'r', t: 21032.774999999674 },
  { key: ' ', t: 21132.649999999558 },
  { key: 'h', t: 21360.905000001367 },
  { key: 'e', t: 21466.31499999785 },
  { key: 'r', t: 21476.31499999785 },
  { key: ' ', t: 21793.05000000022 },
  { key: 'e', t: 22393.34499999677 },
  { key: 'y', t: 22500.154999994265 },
  { key: 'e', t: 22583.435000000463 },
  { key: 's', t: 22737.860000001092 },
  { key: ' ', t: 22882.989999998244 },
  { key: 'd', t: 23067.554999994172 },
  { key: 'i', t: 23183.63999999565 },
  { key: 's', t: 23361.024999998335 },
  { key: 'p', t: 23566.84999999561 },
  { key: 'i', t: 23667.639999999665 },
  { key: 'r', t: 23813.210000000254 },
  { key: 'i', t: 23881.154999995488 },
  { key: 't', t: 24001.964999995835 },
  { key: ',', t: 24462.69499999471 },
  { key: ' ', t: 24535.81000000122 },
  { key: 'd', t: 24828.56499999616 },
  { key: 'r', t: 24920.014999996056 },
  { key: 'a', t: 25065.284999996948 },
  { key: 'w', t: 25119.330000001355 },
  { key: 'n', t: 25270.055000000866 },
  { key: '.', t: 25290.055000000866 },
  { key: ' ', t: 25390.055000000866 },


  { key: 'L', t: 25902.86499999638 },
  { key: 'e', t: 26019.874999998137 },
  { key: 'a', t: 26129.204999997455 },
  { key: 'v', t: 26269.97499999561 },
  { key: 'i', t: 26387.134999997215 },
  { key: 'n', t: 26470.38999999495 },
  { key: 'g', t: 26520.30999999988 },
  { key: ' ', t: 26637.27999999537 },
  { key: 't', t: 26853.92999999749 },
  { key: 'o', t: 26933.33499999426 },
  { key: ' ', t: 26975.659999996424 },
  { key: 't', t: 27054.27499999496 },
  { key: 'h', t: 27154.114999997546 },
  { key: 'e', t: 27237.35499999748 },
  { key: ' ', t: 27321.024999997462 },
  { key: 'g', t: 27488.119999994524 },
  { key: 'r', t: 28105.20999999426 },
  { key: 'o', t: 28298.539999996137 },
  { key: 'a', t: 28368.764999999257 },
  { key: 'n', t: 28538.629999995464 },
  { key: 'i', t: 28655.32499999972 },
  { key: 'n', t: 28733.534999999392 },
  { key: 'g', t: 28845.54499999649 },
  { key: ' ', t: 28933.05999999575 },
  { key: 'd', t: 29072.79999999446 },
  { key: 'o', t: 29165.249999998196 },
  { key: 'o', t: 29332.519999996293 },
  { key: 'r', t: 29332.729999994626 },
  { key: ' ', t: 30117.27499999688 },
  { key: 's', t: 30253.509999995003 },
  { key: 'h', t: 30357.154999997874 },
  { key: 'e', t: 30457.29500000016 },
  { key: ' ', t: 30540.529999998398 },
  { key: 'i', t: 30717.219999998633 },
  { key: 's', t: 30840.96999999747 },
  { key: ' ', t: 30924.114999994345 },
  { key: 't', t: 31057.56499999552 },
  { key: 'h', t: 31140.974999994796 },
  { key: 'e', t: 31241.09999999928 },
  { key: 'n', t: 31333.374999994703 },
  { key: ' ', t: 31407.57499999745 },
  { key: 'd', t: 32607.434999998077 },
  { key: 'r', t: 32707.790000000386 },
  { key: 'a', t: 32824.085000000196 },
  { key: 'w', t: 32908.92999999778 },
  { key: 'n', t: 32086.7549999966 },
  { key: '.', t: 32186.7549999966 }
];

let WW, WH;
let CH, CW;
let str = '';
let gfx;
let timings = [];

window.timings = timings;

window.preload = function() {
  console.log('preload');
};

window.setup = function() {
  CH = 200;
  CW = 400;

  createCanvas(CW, CH);
  gfx = createGraphics(CW, CH);

  WW = windowWidth;
  WH = windowHeight;
};

function update(dt) {
  if (startTime) {

    if (idx < typed.length) {
      let lastTime = typed[idx].t;

      // console.log(lastTime);
      if (millis() - startTime > lastTime) {
        str += typed[idx].key;
        idx++;
      }
    }
  }
}

window.draw = function() {
  update(0.016);
  background(0, 20);

  gfx.background(0, 4);
  gfx.stroke(255);
  gfx.strokeWeight(2);
  gfx.line(0, CH / 2, WW, CH / 2);
  gfx.push();
  gfx.translate(CW / 2, CH / 2);
  gfx.noStroke();
  gfx.fill(255);
  gfx.textAlign(CENTER);
  gfx.textSize(40);
  gfx.text(str, 0, 0);
  gfx.filter(BLUR, 1);
  gfx.text(str, 0, 0);
  gfx.pop();
  gfx.stroke(255);
  gfx.line(0, CH / 2, WW, CH / 2);

  image(gfx, 0, 0);
  // noLoop();
};


// window.draw = function() {
//   update(0.016);
//   background(0);

//   stroke(255);
//   strokeWeight(2);
//   line(0, CH / 2, WW, CH / 2);

//   push();
//   translate(WW / 2, CH / 2);

//   noStroke();
//   fill(255);
//   textAlign(CENTER);

//   textSize(100);
//   text(str, 0, 0);

//   // filter(THRESHOLD);
//   filter(BLUR, 1);
//   // noLoop();

//   text(str, 0, 0);
//   pop();
//   stroke(255);
//   line(0, CH / 2, WW, CH / 2);
// };

window.addEventListener('keydown', k => {
  loop();

  if (k.key === 'Tab') {
    startTime = millis();
    window.setInterval(() => {
      str = '';
      console.clear();
    }, 2000)
  }

  // if (k.key === 'Backspace' && str.length >= 0) {
  //   str = str.substring(0, str.length - 1);
  // } else if (k.key === 'Escape') {
  //   str = '';
  // }
  // //
  // else {
  //   str += k.key;
  //   timings.push({ key: k.key, t: millis() })
  // }
});